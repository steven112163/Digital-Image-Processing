# Instruction of HW2 model training

This is the instruction for model training with the codes under directory "superpixel_modified".
 
 
1. Firstly, under the vitual environment for TensorFlow, install the Keras with: 
   
         pip install keras
	 
   (!) If the you execute the python codes and tell you missed the package "skimage", install the scikit-image: 
   
         pip install scikit-image
   
   
2. The necessary codes are place in the directory "SuperCNN_modified".

	> CNN_train contains the main model code:  
	> "train_superCNN.py": training model code
	> "test_superCNN.py": trained model testing code
	     
	> code contains the Matlab code to finished the image superpixel segmentation.  
	> "training_slic_seg_label.m": superpixel information generating code for training data.  
	> "testing_slic_seg_label.m":  superpixel information generating code for testing data.


3. Before Training and testing, the image and the binary masks shall go through the superpixel segmentation to obtain the segmented results in matleb .mat files.

       1. Place the training data in the "training" directory.
       2. Place the testing data (Generated by you) in the testing direcotory.
       3. Execure the "training_slic_seg_label.m", "testing_slic_seg_label.m". 
       4. The data will be generated into the corresponding directory "train"/"test". 
 
    Note: The directory containing the input images (.jpg) and birinary masks (.png) should have the same file name.
   
    Two files will be generated in the end of execution of slic_seg_label.m
    
          all_Q.mat: superpixel segmentation result of image.
          all_superpixel_labels: superpixel segmentation result of binary mask.
    The Matlab matrix files of training and testing data are necessary for the model.

4. Training the model with "train_superCNN.py" and testing the model with "test_superCNN.py".
  >Make sure the files are placed correctly in the corresponding directory.

          #input data directory path training
            train_image_mat='../train/all_Q.mat'
            train_mask_mat='../train/all_superpixel_labels.mat'
          #testing
            test_image_mat='../test/all_Q.mat'
            test_mask_mat='../test/all_superpixel_labels.mat'
   
  > Training the model with:  
   
         python train_superCNN.py
         
  > Testing the model with:  
   
         python test_superCNN.py
                 
                 
   



 
